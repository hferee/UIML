<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">

<head>
<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
<link href="coqdoc.css" rel="stylesheet" type="text/css" />
<link href="coqdocjs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="config.js"></script>
<script type="text/javascript" src="coqdocjs.js"></script>
</head>

<body onload="document.getElementById('content').focus()">
  <div id="header">
    <span class="left">
      <span class="modulename"> <script> document.write(document.title) </script> </span>
    </span>

    <span class="button" id="toggle-proofs"></span>

    <span class="right">
      <a href="https://github.com/hferee/UIML">Project Page</a>
      <a href="./indexpage.html"> Index </a>
      <a href="./toc.html"> Table of Contents </a>
      <a href="./demo.html"> Demo </a>
    </span>
</div>
    <div id="content" tabindex="-1" onblur="document.getElementById('content').focus()">
    <div id="main">
<h1 class="libtitle">ISL.Order</h1>

<div class="code">
<span class="id" title="keyword">Require</span> <span class="id" title="keyword">Export</span> <a class="idref" href="ISL.SizedFormulas.html#"><span class="id" title="library">ISL.SizedFormulas</span></a> <a class="idref" href="ISL.Formulas.html#"><span class="id" title="library">ISL.Formulas</span></a>.<br/>
<span class="id" title="keyword">Require</span> <span class="id" title="keyword">Export</span> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Lists.List.html#"><span class="id" title="library">List</span></a>.<br/>
<span class="id" title="keyword">Require</span> <span class="id" title="keyword">Export</span> <span class="id" title="library">stdpp.gmultiset</span>.<br/>
<span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Program.Equality.html#"><span class="id" title="library">Coq.Program.Equality</span></a>.<br/>

<br/>
<span class="id" title="keyword">Section</span> <a id="Definitions" class="idref" href="#Definitions"><span class="id" title="section">Definitions</span></a>.<br/>

<br/>
<span class="id" title="keyword">Set Implicit Arguments</span>.<br/>
<span class="id" title="keyword">Variable</span> <a id="Definitions.p" class="idref" href="#Definitions.p"><span class="id" title="variable">p</span></a> : <a class="idref" href="ISL.Formulas.html#variable"><span class="id" title="definition">variable</span></a>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <a id="form_of_sig" class="idref" href="#form_of_sig"><span class="id" title="definition">form_of_sig</span></a> (<a id="s:3" class="idref" href="#s:3"><span class="id" title="binder">s</span></a> : <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Specif.html#e6a434cae860987d1c5f61b342cc9e57"><span class="id" title="notation">{</span></a><a id="n:2" class="idref" href="#n:2"><span class="id" title="binder">n</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Specif.html#e6a434cae860987d1c5f61b342cc9e57"><span class="id" title="notation">&amp;</span></a> @<a class="idref" href="ISL.SizedFormulas.html#nform"><span class="id" title="inductive">nform</span></a> <a class="idref" href="ISL.Order.html#Definitions.p"><span class="id" title="variable">p</span></a> <a class="idref" href="ISL.Order.html#n:2"><span class="id" title="variable">n</span></a><a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Specif.html#e6a434cae860987d1c5f61b342cc9e57"><span class="id" title="notation">}</span></a>) : <a class="idref" href="ISL.Formulas.html#form"><span class="id" title="inductive">form</span></a> := <span class="id" title="keyword">let</span> (<a id="x:4" class="idref" href="#x:4"><span class="id" title="binder">x</span></a>, <a id="n:5" class="idref" href="#n:5"><span class="id" title="binder">n</span></a>) := <a class="idref" href="ISL.Order.html#s:3"><span class="id" title="variable">s</span></a> <span class="id" title="tactic">in</span> <a class="idref" href="ISL.SizedFormulas.html#form_of_nform"><span class="id" title="definition">form_of_nform</span></a> <a class="idref" href="ISL.Order.html#n:5"><span class="id" title="variable">n</span></a>.<br/>
<span class="id" title="keyword">Definition</span> <a id="senv" class="idref" href="#senv"><span class="id" title="definition">senv</span></a>  := <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Datatypes.html#list"><span class="id" title="inductive">list</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Specif.html#e6a434cae860987d1c5f61b342cc9e57"><span class="id" title="notation">{</span></a><a id="n:6" class="idref" href="#n:6"><span class="id" title="binder">n</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Specif.html#e6a434cae860987d1c5f61b342cc9e57"><span class="id" title="notation">&amp;</span></a> @<a class="idref" href="ISL.SizedFormulas.html#nform"><span class="id" title="inductive">nform</span></a> <a class="idref" href="ISL.Order.html#Definitions.p"><span class="id" title="variable">p</span></a> <a class="idref" href="ISL.Order.html#n:6"><span class="id" title="variable">n</span></a><a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Specif.html#e6a434cae860987d1c5f61b342cc9e57"><span class="id" title="notation">}</span></a>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <a id="pow_weight" class="idref" href="#pow_weight"><span class="id" title="definition">pow_weight</span></a> <a id="2ce6039de10a0bcbd8ad52129ba5c704" class="idref" href="#2ce6039de10a0bcbd8ad52129ba5c704"><span class="id" title="binder">n</span></a><a id="2ce6039de10a0bcbd8ad52129ba5c704" class="idref" href="#2ce6039de10a0bcbd8ad52129ba5c704"><span class="id" title="binder">φ</span></a> := 5<a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Arith.PeanoNat.html#81fd94e251a61ee523cdd7855774ae7c"><span class="id" title="notation">^</span></a> <a class="idref" href="ISL.Formulas.html#weight"><span class="id" title="definition">weight</span></a> (<a class="idref" href="ISL.Order.html#form_of_sig"><span class="id" title="definition">form_of_sig</span></a> <a class="idref" href="ISL.Order.html#2ce6039de10a0bcbd8ad52129ba5c704"><span class="id" title="variable">n</span></a><a class="idref" href="ISL.Order.html#2ce6039de10a0bcbd8ad52129ba5c704"><span class="id" title="variable">φ</span></a>).<br/>

<br/>
<span class="comment">(*&nbsp;Note&nbsp;3&nbsp;or&nbsp;4&nbsp;would&nbsp;suffice&nbsp;for&nbsp;IPC&nbsp;;&nbsp;iSL&nbsp;requires&nbsp;5&nbsp;*)</span><br/>
<span class="id" title="keyword">Definition</span> <a id="senv_weight" class="idref" href="#senv_weight"><span class="id" title="definition">senv_weight</span></a> (<a id="d5be501d00a8c9c4c28302f544699b7d" class="idref" href="#d5be501d00a8c9c4c28302f544699b7d"><span class="id" title="binder">Γ</span></a> : <a class="idref" href="ISL.Order.html#senv"><span class="id" title="definition">senv</span></a>) := <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Lists.List.html#list_sum"><span class="id" title="definition">list_sum</span></a> (<a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Lists.List.html#map"><span class="id" title="definition">map</span></a> <a class="idref" href="ISL.Order.html#pow_weight"><span class="id" title="definition">pow_weight</span></a> <a class="idref" href="ISL.Order.html#d5be501d00a8c9c4c28302f544699b7d"><span class="id" title="variable">Γ</span></a>).<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="senv_weight_disj_union" class="idref" href="#senv_weight_disj_union"><span class="id" title="lemma">senv_weight_disj_union</span></a> <a id="a27a3f5be2c643b658176c4fa6dd32d6" class="idref" href="#a27a3f5be2c643b658176c4fa6dd32d6"><span class="id" title="binder">Γ</span></a> <a id="a29d424f5ef817538fc7e2b4f54773f7" class="idref" href="#a29d424f5ef817538fc7e2b4f54773f7"><span class="id" title="binder">Δ</span></a> : <a class="idref" href="ISL.Order.html#senv_weight"><span class="id" title="definition">senv_weight</span></a> (<a class="idref" href="ISL.Order.html#a27a3f5be2c643b658176c4fa6dd32d6"><span class="id" title="variable">Γ</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Datatypes.html#bc347c51eaf667706ae54503b26d52c6"><span class="id" title="notation">++</span></a>  <a class="idref" href="ISL.Order.html#a29d424f5ef817538fc7e2b4f54773f7"><span class="id" title="variable">Δ</span></a>) <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="ISL.Order.html#senv_weight"><span class="id" title="definition">senv_weight</span></a> <a class="idref" href="ISL.Order.html#a27a3f5be2c643b658176c4fa6dd32d6"><span class="id" title="variable">Γ</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Peano.html#0dacc1786c5ba797d47dd85006231633"><span class="id" title="notation">+</span></a>  <a class="idref" href="ISL.Order.html#senv_weight"><span class="id" title="definition">senv_weight</span></a> <a class="idref" href="ISL.Order.html#a29d424f5ef817538fc7e2b4f54773f7"><span class="id" title="variable">Δ</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
<span class="id" title="tactic">unfold</span> <a class="idref" href="ISL.Order.html#senv_weight"><span class="id" title="definition">senv_weight</span></a>.<br/>
<span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Lists.List.html#map_app"><span class="id" title="lemma">map_app</span></a>, <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Lists.List.html#list_sum_app"><span class="id" title="lemma">list_sum_app</span></a>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="senv_weight_add" class="idref" href="#senv_weight_add"><span class="id" title="lemma">senv_weight_add</span></a> (<a id="8a5fb5e1be55058be9aa6b31d1a8bfab" class="idref" href="#8a5fb5e1be55058be9aa6b31d1a8bfab"><span class="id" title="binder">Γ</span></a> : <a class="idref" href="ISL.Order.html#senv"><span class="id" title="definition">senv</span></a>) <a id="3d6a293b00f8bce80d055a66d907400c" class="idref" href="#3d6a293b00f8bce80d055a66d907400c"><span class="id" title="binder">φ</span></a> : <a class="idref" href="ISL.Order.html#senv_weight"><span class="id" title="definition">senv_weight</span></a> ((<a class="idref" href="ISL.Order.html#3d6a293b00f8bce80d055a66d907400c"><span class="id" title="variable">φ</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Datatypes.html#::list_scope:x_'::'_x"><span class="id" title="notation">::</span></a> <a class="idref" href="ISL.Order.html#8a5fb5e1be55058be9aa6b31d1a8bfab"><span class="id" title="variable">Γ</span></a>)) <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="ISL.Order.html#pow_weight"><span class="id" title="definition">pow_weight</span></a> <a class="idref" href="ISL.Order.html#3d6a293b00f8bce80d055a66d907400c"><span class="id" title="variable">φ</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Peano.html#0dacc1786c5ba797d47dd85006231633"><span class="id" title="notation">+</span></a> <a class="idref" href="ISL.Order.html#senv_weight"><span class="id" title="definition">senv_weight</span></a> <a class="idref" href="ISL.Order.html#8a5fb5e1be55058be9aa6b31d1a8bfab"><span class="id" title="variable">Γ</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
<span class="id" title="tactic">unfold</span> <a class="idref" href="ISL.Order.html#senv_weight"><span class="id" title="definition">senv_weight</span></a>. <span class="id" title="tactic">simpl</span>. <span class="id" title="var">lia</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="senv_weight_remove_le" class="idref" href="#senv_weight_remove_le"><span class="id" title="lemma">senv_weight_remove_le</span></a> <a id="e0faa87657dc21b78591e155da331111" class="idref" href="#e0faa87657dc21b78591e155da331111"><span class="id" title="binder">Δ</span></a> <a id="b2587f2dbfee6497283d5741c4979e45" class="idref" href="#b2587f2dbfee6497283d5741c4979e45"><span class="id" title="binder">φ</span></a>:<br/>
&nbsp;&nbsp;<a class="idref" href="ISL.Order.html#senv_weight"><span class="id" title="definition">senv_weight</span></a> (<a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Lists.List.html#remove"><span class="id" title="definition">remove</span></a> (<a class="idref" href="ISL.SizedFormulas.html#nform_eq_dec"><span class="id" title="instance">nform_eq_dec</span></a> <a class="idref" href="ISL.Order.html#Definitions.p"><span class="id" title="variable">p</span></a>) <a class="idref" href="ISL.Order.html#b2587f2dbfee6497283d5741c4979e45"><span class="id" title="variable">φ</span></a> <a class="idref" href="ISL.Order.html#e0faa87657dc21b78591e155da331111"><span class="id" title="variable">Δ</span></a>) <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Unicode.Utf8.html#3ccab6e0e5cec5d8305913b11c2aa678"><span class="id" title="notation">≤</span></a> <a class="idref" href="ISL.Order.html#senv_weight"><span class="id" title="definition">senv_weight</span></a> <a class="idref" href="ISL.Order.html#e0faa87657dc21b78591e155da331111"><span class="id" title="variable">Δ</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
<span class="id" title="tactic">induction</span> <span class="id" title="var">Δ</span> <span class="id" title="keyword">as</span> [|φ' <span class="id" title="var">Δ</span> <span class="id" title="var">HΔ</span>]; <span class="id" title="tactic">trivial</span>.<br/>
<span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">case</span> <a class="idref" href="ISL.SizedFormulas.html#nform_eq_dec"><span class="id" title="instance">nform_eq_dec</span></a>;<br/>
<span class="id" title="tactic">intro</span>; <span class="id" title="tactic">subst</span>; <span class="id" title="tactic">repeat</span> <span class="id" title="tactic">rewrite</span> <a class="idref" href="ISL.Order.html#senv_weight_add"><span class="id" title="lemma">senv_weight_add</span></a>; <span class="id" title="var">lia</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="senv_weight_open_boxes" class="idref" href="#senv_weight_open_boxes"><span class="id" title="lemma">senv_weight_open_boxes</span></a> <a id="7ee6c73ac519f9cc1d66bb79070462a5" class="idref" href="#7ee6c73ac519f9cc1d66bb79070462a5"><span class="id" title="binder">Δ</span></a> : <a class="idref" href="ISL.Order.html#senv_weight"><span class="id" title="definition">senv_weight</span></a> (<a class="idref" href="ISL.SizedFormulas.html#604b299435785c28461a94e94fa58697"><span class="id" title="notation">□</span></a><a class="idref" href="ISL.SizedFormulas.html#604b299435785c28461a94e94fa58697"><span class="id" title="notation">⁻¹</span></a> <a class="idref" href="ISL.Order.html#7ee6c73ac519f9cc1d66bb79070462a5"><span class="id" title="variable">Δ</span></a>) <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Unicode.Utf8.html#3ccab6e0e5cec5d8305913b11c2aa678"><span class="id" title="notation">≤</span></a> <a class="idref" href="ISL.Order.html#senv_weight"><span class="id" title="definition">senv_weight</span></a> <a class="idref" href="ISL.Order.html#7ee6c73ac519f9cc1d66bb79070462a5"><span class="id" title="variable">Δ</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
<span class="id" title="tactic">unfold</span> <a class="idref" href="ISL.Order.html#senv_weight"><span class="id" title="definition">senv_weight</span></a>.<br/>
<span class="id" title="tactic">induction</span> <span class="id" title="var">Δ</span> <span class="id" title="keyword">as</span> [|[<span class="id" title="var">n</span> φ] <span class="id" title="var">Δ</span>]; <span class="id" title="tactic">simpl</span>. <span class="id" title="var">lia</span>.<br/>
<span class="id" title="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Arith.PeanoNat.html#Nat.add_le_mono"><span class="id" title="lemma">Nat.add_le_mono</span></a>; <span class="id" title="tactic">trivial</span>.<br/>
<span class="id" title="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Arith.PeanoNat.html#Nat.pow_le_mono_r"><span class="id" title="lemma">Nat.pow_le_mono_r</span></a>. <span class="id" title="var">lia</span>.<br/>
<span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">destruct</span> φ; <span class="id" title="tactic">simpl</span>; <span class="id" title="tactic">constructor</span>; <span class="id" title="tactic">trivial</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="pow_weight_gt" class="idref" href="#pow_weight_gt"><span class="id" title="lemma">pow_weight_gt</span></a> <a id="1a98fcca75bb9e38590f36614f4e7492" class="idref" href="#1a98fcca75bb9e38590f36614f4e7492"><span class="id" title="binder">φ</span></a> : 5 <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Peano.html#cb53cf0ee22c036a03b4a9281c68b5a3"><span class="id" title="notation">&lt;=</span></a> 5 <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Arith.PeanoNat.html#81fd94e251a61ee523cdd7855774ae7c"><span class="id" title="notation">^</span></a> <a class="idref" href="ISL.Formulas.html#weight"><span class="id" title="definition">weight</span></a> <a class="idref" href="ISL.Order.html#1a98fcca75bb9e38590f36614f4e7492"><span class="id" title="variable">φ</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- (<a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Arith.PeanoNat.html#Nat.pow_1_r"><span class="id" title="definition">Nat.pow_1_r</span></a> 5) <span class="id" title="tactic">at</span> 1.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Arith.PeanoNat.html#Nat.pow_le_mono_r"><span class="id" title="lemma">Nat.pow_le_mono_r</span></a>. <span class="id" title="var">lia</span>. <span class="id" title="tactic">apply</span> <a class="idref" href="ISL.Formulas.html#weight_pos"><span class="id" title="lemma">weight_pos</span></a>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <a id="senv_order" class="idref" href="#senv_order"><span class="id" title="definition">senv_order</span></a> := <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Arith.Wf_nat.html#ltof"><span class="id" title="definition">ltof</span></a> <a class="idref" href="ISL.Order.html#senv"><span class="id" title="definition">senv</span></a> <a class="idref" href="ISL.Order.html#senv_weight"><span class="id" title="definition">senv_weight</span></a>.<br/>
<span class="id" title="keyword">Infix</span> <a id="eb45ebd3fb2f0a4cad93bd8b65f03ccf" class="idref" href="#eb45ebd3fb2f0a4cad93bd8b65f03ccf"><span class="id" title="notation">&quot;</span></a>≺" := <a class="idref" href="ISL.Order.html#senv_order"><span class="id" title="definition">senv_order</span></a> (<span class="id" title="tactic">at</span> <span class="id" title="keyword">level</span> 150).<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="senv_weight_singleton" class="idref" href="#senv_weight_singleton"><span class="id" title="lemma">senv_weight_singleton</span></a> <a id="cf2bafe08dc6a1e0f9e48d8c55d06dab" class="idref" href="#cf2bafe08dc6a1e0f9e48d8c55d06dab"><span class="id" title="binder">φ</span></a> : <a class="idref" href="ISL.Order.html#senv_weight"><span class="id" title="definition">senv_weight</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Lists.List.html#ddd65c2f7ee73ecec433744948d846bb"><span class="id" title="notation">[</span></a> <a class="idref" href="ISL.Order.html#cf2bafe08dc6a1e0f9e48d8c55d06dab"><span class="id" title="variable">φ</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Lists.List.html#ddd65c2f7ee73ecec433744948d846bb"><span class="id" title="notation">]</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> 5 <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Arith.PeanoNat.html#81fd94e251a61ee523cdd7855774ae7c"><span class="id" title="notation">^</span></a> <a class="idref" href="ISL.Formulas.html#weight"><span class="id" title="definition">weight</span></a> (<a class="idref" href="ISL.Order.html#form_of_sig"><span class="id" title="definition">form_of_sig</span></a> <a class="idref" href="ISL.Order.html#cf2bafe08dc6a1e0f9e48d8c55d06dab"><span class="id" title="variable">φ</span></a>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
<span class="id" title="tactic">unfold</span> <a class="idref" href="ISL.Order.html#senv_weight"><span class="id" title="definition">senv_weight</span></a>, <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Arith.Wf_nat.html#ltof"><span class="id" title="definition">ltof</span></a>. <span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">unfold</span> <a class="idref" href="ISL.Order.html#pow_weight"><span class="id" title="definition">pow_weight</span></a>; <span class="id" title="var">lia</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>
<span class="comment">(*<br/>
Lemma&nbsp;env_order_singleton&nbsp;(φ&nbsp;ψ&nbsp;:&nbsp;form)&nbsp;:&nbsp;weight&nbsp;φ&nbsp;&lt;&nbsp;weight&nbsp;ψ&nbsp;-&gt;&nbsp;<span class="inlinecode"></span> <span class="inlinecode">φ</span> <span class="inlinecode">+</span>}≺&nbsp;{<span class="inlinecode">+</span> <span class="inlinecode">ψ</span> <span class="inlinecode">+</span>}.<br/>
Proof.<br/>
intro&nbsp;Hw.&nbsp;unfold&nbsp;env_order,&nbsp;ltof.&nbsp;do&nbsp;2&nbsp;rewrite&nbsp;senv_weight_singleton.<br/>
apply&nbsp;Nat.pow_lt_mono_r.&nbsp;lia.&nbsp;trivial.<br/>
Qed.<br/>
*)</span><br/>
<span class="id" title="keyword">Notation</span> <a id="3d3ee42a79ab3423b56055e3320a3a45" class="idref" href="#3d3ee42a79ab3423b56055e3320a3a45"><span class="id" title="notation">&quot;</span></a>Δ ≼ Δ'" := (<a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Logic.html#f031fe1957c4a4a8e217aa46af2b4e25"><span class="id" title="notation">(</span></a><span class="id" title="var">Δ</span> <a class="idref" href="ISL.Order.html#eb45ebd3fb2f0a4cad93bd8b65f03ccf"><span class="id" title="notation">≺</span></a> <span class="id" title="var">Δ'</span><a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Logic.html#f031fe1957c4a4a8e217aa46af2b4e25"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Logic.html#f031fe1957c4a4a8e217aa46af2b4e25"><span class="id" title="notation">\/</span></a> <span class="id" title="var">Δ</span> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <span class="id" title="var">Δ'</span>) (<span class="id" title="tactic">at</span> <span class="id" title="keyword">level</span> 150).<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="senv_le_weight" class="idref" href="#senv_le_weight"><span class="id" title="lemma">senv_le_weight</span></a> <a id="f9db9c6063ff5f1b15c5099350cc188d" class="idref" href="#f9db9c6063ff5f1b15c5099350cc188d"><span class="id" title="binder">Δ</span></a> <a id="14a54cf28ff703fa0f175a234c605ae8" class="idref" href="#14a54cf28ff703fa0f175a234c605ae8"><span class="id" title="binder">Δ'</span></a> : <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">(</span></a><a class="idref" href="ISL.Order.html#14a54cf28ff703fa0f175a234c605ae8"><span class="id" title="variable">Δ'</span></a> <a class="idref" href="ISL.Order.html#3d3ee42a79ab3423b56055e3320a3a45"><span class="id" title="notation">≼</span></a> <a class="idref" href="ISL.Order.html#f9db9c6063ff5f1b15c5099350cc188d"><span class="id" title="variable">Δ</span></a><a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="ISL.Order.html#senv_weight"><span class="id" title="definition">senv_weight</span></a> <a class="idref" href="ISL.Order.html#14a54cf28ff703fa0f175a234c605ae8"><span class="id" title="variable">Δ'</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Unicode.Utf8.html#3ccab6e0e5cec5d8305913b11c2aa678"><span class="id" title="notation">≤</span></a> <a class="idref" href="ISL.Order.html#senv_weight"><span class="id" title="definition">senv_weight</span></a> <a class="idref" href="ISL.Order.html#f9db9c6063ff5f1b15c5099350cc188d"><span class="id" title="variable">Δ</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
<span class="id" title="tactic">unfold</span> <a class="idref" href="ISL.Order.html#senv_order"><span class="id" title="definition">senv_order</span></a>. <span class="id" title="tactic">intros</span> [<span class="id" title="var">Hle</span> | <span class="id" title="var">Heq</span>].<br/>
- <span class="id" title="tactic">auto</span> <span class="id" title="keyword">with</span> *.<br/>
- <span class="id" title="tactic">subst</span>; <span class="id" title="tactic">trivial</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Global Instance</span> <a id="senv_order_trans" class="idref" href="#senv_order_trans"><span class="id" title="instance">senv_order_trans</span></a> : <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Classes.RelationClasses.html#Transitive"><span class="id" title="class">Transitive</span></a> <a class="idref" href="ISL.Order.html#senv_order"><span class="id" title="definition">senv_order</span></a>.<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">unfold</span> <a class="idref" href="ISL.Order.html#senv_order"><span class="id" title="definition">senv_order</span></a>, <a class="idref" href="ISL.Order.html#senv_weight"><span class="id" title="definition">senv_weight</span></a>, <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Arith.Wf_nat.html#ltof"><span class="id" title="definition">ltof</span></a>. <span class="id" title="tactic">auto</span> <span class="id" title="keyword">with</span> *. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <a id="wf_senv_order" class="idref" href="#wf_senv_order"><span class="id" title="definition">wf_senv_order</span></a> : <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Wf.html#well_founded"><span class="id" title="definition">well_founded</span></a> <a class="idref" href="ISL.Order.html#senv_order"><span class="id" title="definition">senv_order</span></a>.<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Arith.Wf_nat.html#well_founded_lt_compat"><span class="id" title="lemma">well_founded_lt_compat</span></a> <span class="id" title="keyword">with</span> <a class="idref" href="ISL.Order.html#senv_weight"><span class="id" title="definition">senv_weight</span></a>.<br/>
<span class="id" title="keyword">Defined</span>.<br/>

<br/>
<span class="comment">(*&nbsp;We&nbsp;introduce&nbsp;a&nbsp;notion&nbsp;of&nbsp;"pointed"&nbsp;environment,&nbsp;which&nbsp;is&nbsp;simply<br/>
&nbsp;*&nbsp;a&nbsp;pair&nbsp;(Δ,&nbsp;φ),&nbsp;where&nbsp;Δ&nbsp;is&nbsp;an&nbsp;environment&nbsp;and&nbsp;φ&nbsp;is&nbsp;a&nbsp;formula,<br/>
&nbsp;*&nbsp;not&nbsp;necessarily&nbsp;an&nbsp;element&nbsp;of&nbsp;Δ.&nbsp;&nbsp;*)</span><br/>
<span class="id" title="keyword">Definition</span> <a id="pointed_senv" class="idref" href="#pointed_senv"><span class="id" title="definition">pointed_senv</span></a> := (<a class="idref" href="ISL.Order.html#senv"><span class="id" title="definition">senv</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Datatypes.html#11c698c8685bb8ab1cf725545c085ac4"><span class="id" title="notation">*</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Specif.html#e6a434cae860987d1c5f61b342cc9e57"><span class="id" title="notation">{</span></a><a id="n:20" class="idref" href="#n:20"><span class="id" title="binder">n</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Specif.html#e6a434cae860987d1c5f61b342cc9e57"><span class="id" title="notation">&amp;</span></a> @<a class="idref" href="ISL.SizedFormulas.html#nform"><span class="id" title="inductive">nform</span></a> <a class="idref" href="ISL.Order.html#Definitions.p"><span class="id" title="variable">p</span></a> <a class="idref" href="ISL.Order.html#n:20"><span class="id" title="variable">n</span></a><a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Specif.html#e6a434cae860987d1c5f61b342cc9e57"><span class="id" title="notation">}</span></a>)%<span class="id" title="keyword">type</span>.<br/>

<br/>
<span class="comment">(*&nbsp;The&nbsp;order&nbsp;on&nbsp;pointed&nbsp;environments&nbsp;is&nbsp;given&nbsp;by&nbsp;considering&nbsp;the<br/>
&nbsp;*&nbsp;environment&nbsp;order&nbsp;on&nbsp;the&nbsp;sum&nbsp;of&nbsp;Δ&nbsp;and&nbsp;{φ}.&nbsp;*)</span><br/>
&nbsp;<span class="comment">(*&nbsp;TODO:&nbsp;modified&nbsp;from&nbsp;G4IP&nbsp;:&nbsp;right-hand&nbsp;side&nbsp;counts&nbsp;twice,&nbsp;to&nbsp;account&nbsp;for&nbsp;the&nbsp;right&nbsp;box&nbsp;rule.&nbsp;Is&nbsp;this&nbsp;working?&nbsp;*)</span><br/>
<span class="id" title="keyword">Definition</span> <a id="pointed_senv_order" class="idref" href="#pointed_senv_order"><span class="id" title="definition">pointed_senv_order</span></a> (<a id="pe1:21" class="idref" href="#pe1:21"><span class="id" title="binder">pe1</span></a> : <a class="idref" href="ISL.Order.html#pointed_senv"><span class="id" title="definition">pointed_senv</span></a>) (<a id="pe2:22" class="idref" href="#pe2:22"><span class="id" title="binder">pe2</span></a> : <a class="idref" href="ISL.Order.html#pointed_senv"><span class="id" title="definition">pointed_senv</span></a>) :=<br/>
&nbsp;&nbsp;<a class="idref" href="ISL.Order.html#senv_order"><span class="id" title="definition">senv_order</span></a> (<a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Datatypes.html#snd"><span class="id" title="definition">snd</span></a> <a class="idref" href="ISL.Order.html#pe1:21"><span class="id" title="variable">pe1</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Datatypes.html#::list_scope:x_'::'_x"><span class="id" title="notation">::</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Datatypes.html#snd"><span class="id" title="definition">snd</span></a> <a class="idref" href="ISL.Order.html#pe1:21"><span class="id" title="variable">pe1</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Datatypes.html#::list_scope:x_'::'_x"><span class="id" title="notation">::</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Datatypes.html#fst"><span class="id" title="definition">fst</span></a> <a class="idref" href="ISL.Order.html#pe1:21"><span class="id" title="variable">pe1</span></a>) (<a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Datatypes.html#snd"><span class="id" title="definition">snd</span></a> <a class="idref" href="ISL.Order.html#pe2:22"><span class="id" title="variable">pe2</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Datatypes.html#::list_scope:x_'::'_x"><span class="id" title="notation">::</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Datatypes.html#snd"><span class="id" title="definition">snd</span></a> <a class="idref" href="ISL.Order.html#pe2:22"><span class="id" title="variable">pe2</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Datatypes.html#::list_scope:x_'::'_x"><span class="id" title="notation">::</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Datatypes.html#fst"><span class="id" title="definition">fst</span></a> <a class="idref" href="ISL.Order.html#pe2:22"><span class="id" title="variable">pe2</span></a>).<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="wf_pointed_order" class="idref" href="#wf_pointed_order"><span class="id" title="lemma">wf_pointed_order</span></a> : <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Wf.html#well_founded"><span class="id" title="definition">well_founded</span></a> <a class="idref" href="ISL.Order.html#pointed_senv_order"><span class="id" title="definition">pointed_senv_order</span></a>.<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Arith.Wf_nat.html#well_founded_ltof"><span class="id" title="lemma">well_founded_ltof</span></a>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="comment">(*<br/>
Global&nbsp;Instance&nbsp;Proper_senv_order&nbsp;:&nbsp;Proper&nbsp;((≡@{senv})&nbsp;==&gt;&nbsp;(≡@{senv})&nbsp;==&gt;&nbsp;(fun&nbsp;x&nbsp;y&nbsp;=&gt;&nbsp;x&nbsp;&lt;-&gt;&nbsp;y))&nbsp;senv_order.<br/>
Proof.&nbsp;intros&nbsp;Δ1&nbsp;Δ2&nbsp;H12&nbsp;Δ3&nbsp;Δ4&nbsp;H34.<br/>
unfold&nbsp;senv_order,&nbsp;ltof,senv_weight.<br/>
unfold&nbsp;equiv,&nbsp;sets.set_equiv_instance&nbsp;in&nbsp;*.<br/>
&nbsp;apply&nbsp;Permutation_list_sum&nbsp;in&nbsp;H12.<br/>
&nbsp;Qed.<br/>
<br/>
Lemma&nbsp;env_order_equiv_right_compat&nbsp;{Δ&nbsp;Δ'&nbsp;Δ''&nbsp;:&nbsp;senv}:<br/>
&nbsp;&nbsp;Δ'&nbsp;≡&nbsp;Δ''&nbsp;-&gt;<br/>
&nbsp;&nbsp;(Δ&nbsp;≺&nbsp;Δ'')&nbsp;-&gt;<br/>
&nbsp;&nbsp;Δ&nbsp;≺&nbsp;Δ'.<br/>
Proof.&nbsp;unfold&nbsp;senv_order,&nbsp;ltof.&nbsp;unfold&nbsp;equiv.<br/>
<br/>
&nbsp;multiset_solver.&nbsp;Qed.<br/>
<br/>
<br/>
<br/>
Lemma&nbsp;env_order_equiv_left_compat&nbsp;{Δ&nbsp;Δ'&nbsp;Δ''&nbsp;:&nbsp;env}:<br/>
&nbsp;&nbsp;Δ&nbsp;≡&nbsp;Δ''&nbsp;-&gt;<br/>
&nbsp;&nbsp;(Δ''&nbsp;≺&nbsp;Δ')&nbsp;-&gt;<br/>
&nbsp;&nbsp;Δ&nbsp;≺&nbsp;Δ'.<br/>
Proof.&nbsp;ms.&nbsp;Qed.<br/>
<br/>
*)</span><br/>
<span class="comment">(*<br/>
Lemma&nbsp;env_order_1&nbsp;&nbsp;Δ&nbsp;φ1&nbsp;φ&nbsp;:&nbsp;weight&nbsp;φ1&nbsp;&lt;&nbsp;weight&nbsp;φ&nbsp;-&gt;&nbsp;Δ&nbsp;•&nbsp;φ1&nbsp;≺&nbsp;Δ&nbsp;•&nbsp;φ.<br/>
Proof.<br/>
intros&nbsp;Hw.&nbsp;&nbsp;unfold&nbsp;env_order,&nbsp;ltof.&nbsp;do&nbsp;2&nbsp;rewrite&nbsp;senv_weight_add.<br/>
apply&nbsp;Nat.add_lt_mono_l.&nbsp;apply&nbsp;Nat.pow_lt_mono_r.&nbsp;lia.&nbsp;trivial.<br/>
Qed.<br/>
<br/>
Local&nbsp;Hint&nbsp;Resolve&nbsp;Nat.pow_lt_mono_r&nbsp;:&nbsp;order.<br/>
<br/>
Lemma&nbsp;env_order_compat&nbsp;&nbsp;Δ&nbsp;Δ'&nbsp;φ1&nbsp;φ&nbsp;:&nbsp;weight&nbsp;φ1&nbsp;&lt;&nbsp;weight&nbsp;φ&nbsp;-&gt;&nbsp;(Δ'&nbsp;≼&nbsp;Δ)&nbsp;-&gt;&nbsp;Δ'&nbsp;•&nbsp;φ1&nbsp;≺&nbsp;Δ&nbsp;•&nbsp;φ.<br/>
Proof.<br/>
intros.&nbsp;&nbsp;unfold&nbsp;env_order,&nbsp;ltof.&nbsp;repeat&nbsp;rewrite&nbsp;senv_weight_add.<br/>
apply&nbsp;Nat.add_le_lt_mono;&nbsp;auto&nbsp;with&nbsp;*.<br/>
Qed.<br/>
<br/>
Global&nbsp;Hint&nbsp;Resolve&nbsp;env_order_compat&nbsp;:&nbsp;order.<br/>
*)</span><br/>
<span class="id" title="keyword">Lemma</span> <a id="env_order_add_compat" class="idref" href="#env_order_add_compat"><span class="id" title="lemma">env_order_add_compat</span></a> <a id="da040409d18a8979ea60ea19ee07df4c" class="idref" href="#da040409d18a8979ea60ea19ee07df4c"><span class="id" title="binder">Δ</span></a> <a id="4703434a5701ad93e2577e843fa6d86a" class="idref" href="#4703434a5701ad93e2577e843fa6d86a"><span class="id" title="binder">Δ'</span></a> <a id="fb3e85b59dc6391d0ecbb754d62cffcd" class="idref" href="#fb3e85b59dc6391d0ecbb754d62cffcd"><span class="id" title="binder">φ</span></a> : <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">(</span></a><a class="idref" href="ISL.Order.html#da040409d18a8979ea60ea19ee07df4c"><span class="id" title="variable">Δ</span></a> <a class="idref" href="ISL.Order.html#eb45ebd3fb2f0a4cad93bd8b65f03ccf"><span class="id" title="notation">≺</span></a> <a class="idref" href="ISL.Order.html#4703434a5701ad93e2577e843fa6d86a"><span class="id" title="variable">Δ'</span></a><a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="ISL.Order.html#eb45ebd3fb2f0a4cad93bd8b65f03ccf"><span class="id" title="notation">(</span></a><a class="idref" href="ISL.Order.html#fb3e85b59dc6391d0ecbb754d62cffcd"><span class="id" title="variable">φ</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Datatypes.html#::list_scope:x_'::'_x"><span class="id" title="notation">::</span></a> <a class="idref" href="ISL.Order.html#da040409d18a8979ea60ea19ee07df4c"><span class="id" title="variable">Δ</span></a><a class="idref" href="ISL.Order.html#eb45ebd3fb2f0a4cad93bd8b65f03ccf"><span class="id" title="notation">)</span></a> <a class="idref" href="ISL.Order.html#eb45ebd3fb2f0a4cad93bd8b65f03ccf"><span class="id" title="notation">≺</span></a> <a class="idref" href="ISL.Order.html#eb45ebd3fb2f0a4cad93bd8b65f03ccf"><span class="id" title="notation">(</span></a><a class="idref" href="ISL.Order.html#fb3e85b59dc6391d0ecbb754d62cffcd"><span class="id" title="variable">φ</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Datatypes.html#::list_scope:x_'::'_x"><span class="id" title="notation">::</span></a> <a class="idref" href="ISL.Order.html#4703434a5701ad93e2577e843fa6d86a"><span class="id" title="variable">Δ'</span></a><a class="idref" href="ISL.Order.html#eb45ebd3fb2f0a4cad93bd8b65f03ccf"><span class="id" title="notation">)</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
<span class="id" title="tactic">unfold</span> <a class="idref" href="ISL.Order.html#senv_order"><span class="id" title="definition">senv_order</span></a>, <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Arith.Wf_nat.html#ltof"><span class="id" title="definition">ltof</span></a>. <span class="id" title="tactic">do</span> 2 <span class="id" title="tactic">rewrite</span> <a class="idref" href="ISL.Order.html#senv_weight_add"><span class="id" title="lemma">senv_weight_add</span></a>. <span class="id" title="var">lia</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>
<span class="comment">(*<br/>
<span class="comment">(*&nbsp;TODO:&nbsp;this&nbsp;is&nbsp;just&nbsp;a&nbsp;special&nbsp;case&nbsp;*)</span><br/>
Lemma&nbsp;env_order_disj_union_compat_left&nbsp;Δ&nbsp;Δ'&nbsp;Δ'':<br/>
&nbsp;&nbsp;(Δ&nbsp;≺&nbsp;Δ'')&nbsp;-&gt;&nbsp;Δ&nbsp;⊎&nbsp;Δ'&nbsp;≺&nbsp;Δ''&nbsp;⊎&nbsp;Δ'.<br/>
Proof.<br/>
unfold&nbsp;env_order,&nbsp;ltof.&nbsp;intro.&nbsp;do&nbsp;2&nbsp;rewrite&nbsp;senv_weight_disj_union.&nbsp;lia.<br/>
Qed.<br/>
<br/>
<br/>
Lemma&nbsp;env_order_disj_union_compat_right&nbsp;Δ&nbsp;Δ'&nbsp;Δ'':<br/>
&nbsp;&nbsp;(Δ&nbsp;≺&nbsp;Δ'')&nbsp;-&gt;&nbsp;Δ'&nbsp;⊎&nbsp;Δ&nbsp;≺&nbsp;Δ'&nbsp;⊎&nbsp;Δ''.<br/>
Proof.<br/>
intro&nbsp;H.&nbsp;eapply&nbsp;(Proper_env_order&nbsp;&nbsp;_&nbsp;(Δ&nbsp;⊎&nbsp;Δ')&nbsp;_&nbsp;_&nbsp;(Δ''&nbsp;⊎&nbsp;Δ'))&nbsp;.&nbsp;ms.&nbsp;<br/>
now&nbsp;apply&nbsp;env_order_disj_union_compat_left.<br/>
Unshelve.&nbsp;ms.<br/>
Qed.<br/>
<br/>
Lemma&nbsp;env_order_disj_union_compat&nbsp;Δ&nbsp;Δ'&nbsp;Δ''&nbsp;Δ''':<br/>
&nbsp;&nbsp;(Δ&nbsp;≺&nbsp;Δ'')&nbsp;-&gt;&nbsp;(Δ'&nbsp;≺&nbsp;Δ''')&nbsp;-&gt;&nbsp;Δ&nbsp;⊎&nbsp;Δ'&nbsp;≺&nbsp;Δ''&nbsp;⊎&nbsp;Δ'''.<br/>
Proof.<br/>
intros&nbsp;H1&nbsp;H2.<br/>
transitivity&nbsp;(Δ&nbsp;&nbsp;⊎&nbsp;Δ''').<br/>
-&nbsp;now&nbsp;apply&nbsp;env_order_disj_union_compat_right.<br/>
-&nbsp;now&nbsp;apply&nbsp;env_order_disj_union_compat_left.<br/>
Qed.<br/>
<br/>
<br/>
Lemma&nbsp;env_order_disj_union_compat_strong_right&nbsp;Δ&nbsp;Δ'&nbsp;Δ''&nbsp;Δ''':<br/>
&nbsp;&nbsp;(Δ&nbsp;≺&nbsp;Δ'')&nbsp;-&gt;&nbsp;(Δ'&nbsp;≼&nbsp;Δ''')&nbsp;-&gt;&nbsp;Δ&nbsp;⊎&nbsp;Δ'&nbsp;≺&nbsp;Δ''&nbsp;⊎&nbsp;Δ'''.<br/>
Proof.<br/>
intros&nbsp;H1&nbsp;H2.&nbsp;<br/>
destruct&nbsp;H2&nbsp;as&nbsp;<span class="inlinecode"><span class="id" title="var">Hlt</span>|<span class="id" title="var">Heq</span></span>.<br/>
-&nbsp;unfold&nbsp;env_order,&nbsp;ltof&nbsp;in&nbsp;*.&nbsp;do&nbsp;2&nbsp;rewrite&nbsp;senv_weight_disj_union.&nbsp;lia.<br/>
-&nbsp;rewrite&nbsp;Heq.&nbsp;now&nbsp;apply&nbsp;env_order_disj_union_compat_left.<br/>
Qed.<br/>
<br/>
Lemma&nbsp;env_order_disj_union_compat_strong_left&nbsp;Δ&nbsp;Δ'&nbsp;Δ''&nbsp;Δ''':<br/>
&nbsp;&nbsp;(Δ&nbsp;≼&nbsp;Δ'')&nbsp;-&gt;&nbsp;(Δ'&nbsp;≺&nbsp;Δ''')&nbsp;-&gt;&nbsp;Δ&nbsp;⊎&nbsp;Δ'&nbsp;≺&nbsp;Δ''&nbsp;⊎&nbsp;Δ'''.<br/>
Proof.<br/>
intros&nbsp;H1&nbsp;H2.&nbsp;<br/>
destruct&nbsp;H1&nbsp;as&nbsp;<span class="inlinecode"><span class="id" title="var">Hlt</span>|<span class="id" title="var">Heq</span></span>.<br/>
-&nbsp;unfold&nbsp;env_order,&nbsp;ltof&nbsp;in&nbsp;*.&nbsp;do&nbsp;2&nbsp;rewrite&nbsp;senv_weight_disj_union.&nbsp;lia.<br/>
-&nbsp;rewrite&nbsp;Heq.&nbsp;now&nbsp;apply&nbsp;env_order_disj_union_compat_right.<br/>
Qed.<br/>
<br/>
Lemma&nbsp;open_boxes_env_order&nbsp;Δ&nbsp;:&nbsp;(⊗Δ)&nbsp;≼&nbsp;Δ.<br/>
Proof.<br/>
induction&nbsp;Δ&nbsp;as&nbsp;<span class="inlinecode">|φ</span> <span class="inlinecode"><span class="id" title="var">Δ</span></span>&nbsp;using&nbsp;gmultiset_rec.<br/>
-&nbsp;right.&nbsp;autorewrite&nbsp;with&nbsp;proof.&nbsp;auto.<br/>
-&nbsp;destruct&nbsp;IHΔ&nbsp;as&nbsp;<span class="inlinecode"><span class="id" title="var">Hlt</span></span> <span class="inlinecode">|</span> <span class="inlinecode"><span class="id" title="var">Heq</span></span>.<br/>
&nbsp;&nbsp;+&nbsp;left.&nbsp;autorewrite&nbsp;with&nbsp;proof.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;apply&nbsp;env_order_disj_union_compat_strong_left;&nbsp;trivial.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;destruct&nbsp;φ;&nbsp;simpl;&nbsp;try&nbsp;ms.&nbsp;left.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;apply&nbsp;env_order_singleton.&nbsp;simpl.&nbsp;lia.<br/>
&nbsp;&nbsp;+&nbsp;rewrite&nbsp;open_boxes_disj_union,&nbsp;open_boxes_singleton,&nbsp;Heq.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;case_eq&nbsp;(is_box&nbsp;φ);&nbsp;intro&nbsp;Hbox;&nbsp;simpl.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;left.&nbsp;apply&nbsp;env_order_disj_union_compat_strong_right;&nbsp;<span class="inlinecode">|<span class="id" title="var">ms</span></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;destruct&nbsp;φ;&nbsp;simpl&nbsp;in&nbsp;*;&nbsp;try&nbsp;inversion&nbsp;Hbox.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;apply&nbsp;env_order_singleton.&nbsp;simpl.&nbsp;lia.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;right.&nbsp;destruct&nbsp;φ;&nbsp;simpl&nbsp;in&nbsp;*;&nbsp;ms.<br/>
Qed.<br/>
<br/>
Global&nbsp;Hint&nbsp;Resolve&nbsp;open_boxes_env_order&nbsp;:&nbsp;order.<br/>
<br/>
Lemma&nbsp;env_order_0&nbsp;Δ&nbsp;φ:&nbsp;Δ&nbsp;≺&nbsp;Δ&nbsp;•&nbsp;φ.<br/>
Proof.<br/>
unfold&nbsp;env_order,&nbsp;ltof.&nbsp;rewrite&nbsp;senv_weight_disj_union,&nbsp;senv_weight_singleton.<br/>
apply&nbsp;Nat.lt_add_pos_r.&nbsp;transitivity&nbsp;(5&nbsp;^&nbsp;0).&nbsp;simpl.&nbsp;lia.&nbsp;apply&nbsp;Nat.pow_lt_mono_r.&nbsp;lia.<br/>
apply&nbsp;weight_pos.<br/>
Qed.<br/>
<br/>
<span class="comment">(*&nbsp;TODO:&nbsp;ok?&nbsp;to&nbsp;replace&nbsp;env_order_*&nbsp;?<br/>
Lemma&nbsp;env_order_l&nbsp;(Δ'&nbsp;Δ:&nbsp;env)&nbsp;φ1&nbsp;φ:&nbsp;weight&nbsp;φ1&nbsp;&lt;&nbsp;weight&nbsp;φ&nbsp;-&gt;&nbsp;(Δ'&nbsp;≺&nbsp;Δ&nbsp;•&nbsp;φ)&nbsp;-&gt;&nbsp;(Δ'&nbsp;•&nbsp;φ1)&nbsp;≺&nbsp;(Δ&nbsp;•&nbsp;φ).<br/>
Proof.<br/>
*)</span><br/>
<br/>
Local&nbsp;Lemma&nbsp;pow5_gt_0&nbsp;n&nbsp;:&nbsp;1&nbsp;≤&nbsp;5&nbsp;^&nbsp;n.<br/>
Proof.&nbsp;transitivity&nbsp;(5^0).&nbsp;simpl.&nbsp;lia.&nbsp;apply&nbsp;Nat.pow_le_mono_r;&nbsp;lia.&nbsp;Qed.<br/>
<br/>
Local&nbsp;Hint&nbsp;Resolve&nbsp;pow5_gt_0:&nbsp;order.<br/>
<br/>
Lemma&nbsp;env_order_2&nbsp;&nbsp;Δ&nbsp;Δ'&nbsp;φ1&nbsp;φ2&nbsp;φ:&nbsp;weight&nbsp;φ1&nbsp;&lt;&nbsp;weight&nbsp;φ&nbsp;-&gt;&nbsp;weight&nbsp;φ2&nbsp;&lt;&nbsp;weight&nbsp;φ&nbsp;-&gt;<br/>
&nbsp;&nbsp;(Δ'&nbsp;≼&nbsp;Δ)&nbsp;-&gt;&nbsp;Δ'&nbsp;•&nbsp;φ1&nbsp;•&nbsp;φ2&nbsp;≺&nbsp;Δ&nbsp;•&nbsp;φ.<br/>
Proof.<br/>
intros&nbsp;Hw1&nbsp;Hw2&nbsp;Hor.<br/>
unfold&nbsp;env_order,&nbsp;ltof.&nbsp;repeat&nbsp;rewrite&nbsp;senv_weight_add.<br/>
apply&nbsp;senv_le_weight&nbsp;in&nbsp;Hor.<br/>
replace&nbsp;(weight&nbsp;φ)&nbsp;with&nbsp;(S&nbsp;(pred&nbsp;(weight&nbsp;φ)))&nbsp;by&nbsp;lia.<br/>
apply&nbsp;Nat.lt_le_pred&nbsp;in&nbsp;Hw1,&nbsp;Hw2.<br/>
simpl.&nbsp;repeat&nbsp;rewrite&nbsp;Nat.add_assoc.<br/>
pose&nbsp;(pow5_gt_0&nbsp;(Init.Nat.pred&nbsp;(weight&nbsp;φ))).<br/>
rewrite&nbsp;Nat.add_0_r.<br/>
repeat&nbsp;(apply&nbsp;Nat.add_lt_le_mono;&nbsp;<span class="inlinecode">|<span class="id" title="tactic">apply</span></span> <span class="inlinecode"><span class="id" title="var">Nat.pow_le_mono_r</span>;</span> <span class="inlinecode"><span class="id" title="var">lia</span></span>).<br/>
pose&nbsp;(pow5_gt_0&nbsp;(Init.Nat.pred&nbsp;(weight&nbsp;φ))).<br/>
lia.<br/>
Qed.<br/>
<br/>
Lemma&nbsp;env_order_3&nbsp;&nbsp;Δ&nbsp;Δ'&nbsp;φ1&nbsp;φ2&nbsp;φ3&nbsp;φ:&nbsp;<br/>
&nbsp;&nbsp;weight&nbsp;φ1&nbsp;&lt;&nbsp;weight&nbsp;φ&nbsp;-&gt;&nbsp;weight&nbsp;φ2&nbsp;&lt;&nbsp;weight&nbsp;φ&nbsp;-&gt;&nbsp;weight&nbsp;φ3&nbsp;&lt;&nbsp;weight&nbsp;φ&nbsp;-&gt;&nbsp;(Δ'&nbsp;≼&nbsp;Δ)&nbsp;-&gt;<br/>
&nbsp;&nbsp;Δ'&nbsp;•&nbsp;φ1&nbsp;•&nbsp;φ2&nbsp;&nbsp;•&nbsp;φ3&nbsp;≺&nbsp;Δ&nbsp;•&nbsp;φ.<br/>
Proof.<br/>
intros&nbsp;Hw1&nbsp;Hw2&nbsp;Hw3&nbsp;Hor.<br/>
unfold&nbsp;env_order,&nbsp;ltof.&nbsp;repeat&nbsp;rewrite&nbsp;senv_weight_add.<br/>
apply&nbsp;senv_le_weight&nbsp;in&nbsp;Hor.<br/>
replace&nbsp;(weight&nbsp;φ)&nbsp;with&nbsp;(S&nbsp;(pred&nbsp;(weight&nbsp;φ)))&nbsp;by&nbsp;lia.<br/>
apply&nbsp;Nat.lt_le_pred&nbsp;in&nbsp;Hw1,&nbsp;Hw2.<br/>
simpl.&nbsp;repeat&nbsp;rewrite&nbsp;Nat.add_assoc.<br/>
pose&nbsp;(pow5_gt_0&nbsp;(Init.Nat.pred&nbsp;(weight&nbsp;φ))).<br/>
rewrite&nbsp;Nat.add_0_r.<br/>
do&nbsp;3&nbsp;(apply&nbsp;Nat.add_lt_le_mono;&nbsp;<span class="inlinecode">|<span class="id" title="tactic">apply</span></span> <span class="inlinecode"><span class="id" title="var">Nat.pow_le_mono_r</span>;</span> <span class="inlinecode"><span class="id" title="var">lia</span></span>).<br/>
pose&nbsp;(pow5_gt_0&nbsp;(Init.Nat.pred&nbsp;(weight&nbsp;φ))).<br/>
lia.<br/>
Qed.<br/>
<br/>
Lemma&nbsp;env_order_4&nbsp;&nbsp;Δ&nbsp;Δ'&nbsp;φ1&nbsp;φ2&nbsp;φ3&nbsp;φ4&nbsp;φ:&nbsp;<br/>
&nbsp;&nbsp;weight&nbsp;φ1&nbsp;&lt;&nbsp;weight&nbsp;φ&nbsp;-&gt;&nbsp;weight&nbsp;φ2&nbsp;&lt;&nbsp;weight&nbsp;φ&nbsp;-&gt;&nbsp;weight&nbsp;φ3&nbsp;&lt;&nbsp;weight&nbsp;φ&nbsp;-&gt;&nbsp;weight&nbsp;φ4&nbsp;&lt;&nbsp;weight&nbsp;φ&nbsp;-&gt;<br/>
&nbsp;&nbsp;&nbsp;(Δ'&nbsp;≼&nbsp;Δ)&nbsp;-&gt;&nbsp;Δ'&nbsp;•&nbsp;φ1&nbsp;•&nbsp;φ2&nbsp;&nbsp;•&nbsp;φ3&nbsp;•&nbsp;φ4&nbsp;≺&nbsp;Δ&nbsp;•&nbsp;φ.<br/>
Proof.<br/>
intros&nbsp;Hw1&nbsp;Hw2&nbsp;Hw3&nbsp;Hw4&nbsp;Hor.<br/>
unfold&nbsp;env_order,&nbsp;ltof.&nbsp;repeat&nbsp;rewrite&nbsp;senv_weight_add.<br/>
apply&nbsp;senv_le_weight&nbsp;in&nbsp;Hor.<br/>
replace&nbsp;(weight&nbsp;φ)&nbsp;with&nbsp;(S&nbsp;(pred&nbsp;(weight&nbsp;φ)))&nbsp;by&nbsp;lia.<br/>
apply&nbsp;Nat.lt_le_pred&nbsp;in&nbsp;Hw1,&nbsp;Hw2.<br/>
simpl.&nbsp;repeat&nbsp;rewrite&nbsp;Nat.add_assoc.<br/>
pose&nbsp;(pow5_gt_0&nbsp;(Init.Nat.pred&nbsp;(weight&nbsp;φ))).<br/>
rewrite&nbsp;Nat.add_0_r.<br/>
do&nbsp;4&nbsp;(apply&nbsp;Nat.add_lt_le_mono;&nbsp;<span class="inlinecode">|<span class="id" title="tactic">apply</span></span> <span class="inlinecode"><span class="id" title="var">Nat.pow_le_mono_r</span>;</span> <span class="inlinecode"><span class="id" title="var">lia</span></span>).<br/>
pose&nbsp;(pow5_gt_0&nbsp;(Init.Nat.pred&nbsp;(weight&nbsp;φ))).<br/>
lia.<br/>
Qed.<br/>
<br/>
<br/>
<br/>
Lemma&nbsp;env_order_cancel_right&nbsp;Δ&nbsp;Δ'&nbsp;φ:&nbsp;&nbsp;(Δ&nbsp;≺&nbsp;Δ')&nbsp;-&gt;&nbsp;Δ&nbsp;≺&nbsp;(Δ'&nbsp;•&nbsp;φ).<br/>
Proof.&nbsp;etransitivity;&nbsp;<span class="inlinecode">|<span class="id" title="tactic">apply</span></span> <span class="inlinecode"><span class="id" title="var">env_order_0</span></span>.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assumption.&nbsp;Qed.<br/>
<br/>
<br/>
Lemma&nbsp;env_order_eq_add&nbsp;Δ&nbsp;Δ'&nbsp;φ:&nbsp;(Δ&nbsp;≼&nbsp;Δ')&nbsp;-&gt;&nbsp;(Δ&nbsp;•&nbsp;φ)&nbsp;≼&nbsp;(Δ'&nbsp;•&nbsp;φ).<br/>
Proof.&nbsp;intros<span class="inlinecode"><span class="id" title="var">Heq</span>|<span class="id" title="var">Hlt</span></span>.&nbsp;left.&nbsp;now&nbsp;apply&nbsp;env_order_add_compat.&nbsp;right.&nbsp;ms.&nbsp;Qed.<br/>
*)</span><br/>
<span class="id" title="keyword">End</span> <a class="idref" href="ISL.Order.html#Definitions"><span class="id" title="section">Definitions</span></a>.<br/>

<br/>
<span class="comment">(*<br/>
Global&nbsp;Hint&nbsp;Resolve&nbsp;env_order_0&nbsp;:&nbsp;order.<br/>
Global&nbsp;Hint&nbsp;Resolve&nbsp;env_order_1&nbsp;:&nbsp;order.<br/>
Global&nbsp;Hint&nbsp;Resolve&nbsp;env_order_2&nbsp;:&nbsp;order.<br/>
Global&nbsp;Hint&nbsp;Resolve&nbsp;env_order_3&nbsp;:&nbsp;order.<br/>
Global&nbsp;Hint&nbsp;Resolve&nbsp;env_order_4&nbsp;:&nbsp;order.<br/>
Global&nbsp;Hint&nbsp;Resolve&nbsp;env_order_add_compat&nbsp;:&nbsp;order.<br/>
Global&nbsp;Hint&nbsp;Resolve&nbsp;env_order_cancel_right&nbsp;:&nbsp;order.<br/>
Global&nbsp;Hint&nbsp;Resolve&nbsp;env_order_eq_add&nbsp;:&nbsp;order.<br/>
Global&nbsp;Hint&nbsp;Extern&nbsp;1&nbsp;(?a&nbsp;&lt;&nbsp;?b)&nbsp;=&gt;&nbsp;subst;&nbsp;simpl;&nbsp;lia&nbsp;:&nbsp;order.<br/>
<br/>
Ltac&nbsp;get_diff_form&nbsp;g&nbsp;:=&nbsp;match&nbsp;g&nbsp;with<br/>
|&nbsp;?Γ&nbsp;∖{<span class="inlinecode">?φ</span>}&nbsp;=&gt;&nbsp;φ<br/>
|&nbsp;_&nbsp;(?Γ&nbsp;∖{<span class="inlinecode">?φ</span>})&nbsp;=&gt;&nbsp;φ<br/>
|&nbsp;?Γ&nbsp;•&nbsp;_&nbsp;=&gt;&nbsp;get_diff_form&nbsp;Γ<br/>
end.<br/>
<br/>
Ltac&nbsp;get_diff_env&nbsp;g&nbsp;:=&nbsp;match&nbsp;g&nbsp;with<br/>
|&nbsp;?Γ&nbsp;∖{<span class="inlinecode">?φ</span>}&nbsp;=&gt;&nbsp;Γ<br/>
|&nbsp;?Γ&nbsp;•&nbsp;_&nbsp;=&gt;&nbsp;get_diff_env&nbsp;Γ<br/>
end.<br/>
<br/>
Global&nbsp;Hint&nbsp;Rewrite&nbsp;open_boxes_remove&nbsp;:&nbsp;order.<br/>
*)</span><br/>

<br/>
<span class="id" title="keyword">Ltac</span> <span class="id" title="var">prepare_order</span> := <span class="id" title="tactic">idtac</span>.<br/>
<span class="comment">(*<br/>
repeat&nbsp;(apply&nbsp;env_order_add_compat);<br/>
unfold&nbsp;pointed_env_order;&nbsp;subst;&nbsp;simpl;&nbsp;repeat&nbsp;rewrite&nbsp;open_boxes_add;&nbsp;try&nbsp;match&nbsp;goal&nbsp;with<br/>
|&nbsp;Δ&nbsp;:=&nbsp;_&nbsp;|-&nbsp;_&nbsp;=&gt;&nbsp;subst&nbsp;Δ;&nbsp;try&nbsp;prepare_order<br/>
|&nbsp;H&nbsp;:&nbsp;?ψ&nbsp;∈&nbsp;?Γ&nbsp;|-&nbsp;?Γ'&nbsp;≺&nbsp;?Γ&nbsp;=&gt;&nbsp;let&nbsp;ψ'&nbsp;:=&nbsp;(get_diff_form&nbsp;Γ')&nbsp;in<br/>
&nbsp;&nbsp;&nbsp;&nbsp;apply&nbsp;(env_order_equiv_right_compat&nbsp;(difference_singleton&nbsp;Γ&nbsp;ψ'&nbsp;H))<br/>
|&nbsp;H&nbsp;:&nbsp;?ψ&nbsp;∈&nbsp;?Γ&nbsp;|-&nbsp;?Γ'&nbsp;≺&nbsp;?Γ&nbsp;•&nbsp;?φ&nbsp;=&gt;&nbsp;let&nbsp;ψ'&nbsp;:=&nbsp;(get_diff_form&nbsp;Γ')&nbsp;in<br/>
&nbsp;&nbsp;&nbsp;&nbsp;apply&nbsp;(env_order_equiv_right_compat&nbsp;(equiv_disj_union_compat_r(difference_singleton&nbsp;Γ&nbsp;ψ'&nbsp;H)))<br/>
|&nbsp;H&nbsp;:&nbsp;?ψ&nbsp;∈&nbsp;?Γ&nbsp;|-&nbsp;?Γ'&nbsp;≺&nbsp;?Γ&nbsp;•&nbsp;_&nbsp;•&nbsp;_&nbsp;=&gt;&nbsp;let&nbsp;ψ'&nbsp;:=&nbsp;(get_diff_form&nbsp;Γ')&nbsp;in<br/>
apply&nbsp;(env_order_equiv_right_compat&nbsp;(equiv_disj_union_compat_r(equiv_disj_union_compat_r(difference_singleton&nbsp;Γ&nbsp;ψ'&nbsp;H))))<br/>
end.<br/>
<span class="comment">(*<br/>
Global&nbsp;Hint&nbsp;Extern&nbsp;2&nbsp;((?Γ&nbsp;&nbsp;∖&nbsp;{<span class="inlinecode">?ψ</span>}&nbsp;,&nbsp;?φ)&nbsp;≺·&nbsp;(?Γ,&nbsp;?φ))&nbsp;=&gt;&nbsp;prepare_order&nbsp;:&nbsp;order.<br/>
Global&nbsp;Hint&nbsp;Extern&nbsp;2&nbsp;(?Γ&nbsp;&nbsp;∖&nbsp;{<span class="inlinecode">?ψ</span>}&nbsp;•&nbsp;?φ'&nbsp;•&nbsp;?φ''&nbsp;≺&nbsp;?Γ&nbsp;•&nbsp;?φ)&nbsp;=&gt;&nbsp;prepare_order&nbsp;:&nbsp;order.<br/>
Global&nbsp;Hint&nbsp;Extern&nbsp;2&nbsp;(?Γ&nbsp;&nbsp;∖&nbsp;{<span class="inlinecode">?ψ</span>}&nbsp;•&nbsp;?φ'&nbsp;•&nbsp;?φ''&nbsp;≺&nbsp;?Γ&nbsp;•&nbsp;?φ&nbsp;•&nbsp;?φ''')&nbsp;=&gt;&nbsp;prepare_order&nbsp;:&nbsp;order.<br/>
Global&nbsp;Hint&nbsp;Extern&nbsp;2&nbsp;(?Γ&nbsp;&nbsp;∖&nbsp;{<span class="inlinecode">?ψ</span>}&nbsp;•&nbsp;?φ'&nbsp;•&nbsp;?φ''&nbsp;•&nbsp;?φ''''&nbsp;≺&nbsp;?Γ&nbsp;•&nbsp;?φ&nbsp;•&nbsp;?φ''')&nbsp;=&gt;&nbsp;prepare_order&nbsp;:&nbsp;order.<br/>
Global&nbsp;Hint&nbsp;Extern&nbsp;2&nbsp;(?Γ&nbsp;&nbsp;∖&nbsp;{<span class="inlinecode">?ψ</span>}&nbsp;•&nbsp;?φ'&nbsp;≺&nbsp;?Γ&nbsp;•&nbsp;?φ)&nbsp;=&gt;&nbsp;prepare_order&nbsp;:&nbsp;order.<br/>
Global&nbsp;Hint&nbsp;Extern&nbsp;2&nbsp;(?Γ&nbsp;&nbsp;∖&nbsp;{<span class="inlinecode">?ψ</span>}&nbsp;•&nbsp;?φ'&nbsp;≺&nbsp;?Γ&nbsp;•&nbsp;?φ&nbsp;&nbsp;•&nbsp;?φ')&nbsp;=&gt;&nbsp;prepare_order&nbsp;:&nbsp;order.<br/>
*)</span><br/>
Lemma&nbsp;make_impl_weight&nbsp;φ&nbsp;ψ:&nbsp;weight&nbsp;(φ&nbsp;⇢&nbsp;ψ)&nbsp;&lt;=&nbsp;weight&nbsp;(φ&nbsp;→&nbsp;ψ).<br/>
Proof.<br/>
destruct&nbsp;(make_impl_spec&nbsp;φ&nbsp;ψ)&nbsp;as&nbsp;<span class="inlinecode">[[<span class="id" title="var">Heq'</span></span> <span class="inlinecode"><span class="id" title="var">Heq</span>]|[<span class="id" title="var">Heq'</span></span> <span class="inlinecode"><span class="id" title="var">Heq</span>]]|<span class="id" title="var">Heq</span></span>;&nbsp;subst;&nbsp;rewrite&nbsp;Heq;&nbsp;simpl.<br/>
-&nbsp;assert&nbsp;(H&nbsp;:=&nbsp;weight_pos&nbsp;ψ).&nbsp;lia.<br/>
-&nbsp;&nbsp;lia.<br/>
-&nbsp;trivial.<br/>
Qed.<br/>
<br/>
Lemma&nbsp;make_impl_weight2&nbsp;φ&nbsp;ψ&nbsp;θ:&nbsp;weight&nbsp;(φ&nbsp;⇢&nbsp;(ψ&nbsp;⇢&nbsp;θ))&nbsp;&lt;=&nbsp;weight&nbsp;(φ&nbsp;→&nbsp;(ψ&nbsp;→&nbsp;θ)).<br/>
Proof.<br/>
pose&nbsp;(make_impl_weight&nbsp;ψ&nbsp;θ).<br/>
pose&nbsp;(make_impl_weight&nbsp;φ&nbsp;(ψ&nbsp;⇢&nbsp;θ)).<br/>
simpl&nbsp;in&nbsp;*.&nbsp;lia.<br/>
Qed.<br/>
<br/>
Global&nbsp;Hint&nbsp;Extern&nbsp;&nbsp;5&nbsp;&nbsp;(weight&nbsp;(?φ&nbsp;⇢&nbsp;?ψ)&nbsp;&lt;&nbsp;_)&nbsp;=&gt;&nbsp;(eapply&nbsp;Nat.le_lt_trans;&nbsp;<span class="inlinecode"><span class="id" title="tactic">eapply</span></span> <span class="inlinecode"><span class="id" title="var">make_impl_weight</span>|</span>)&nbsp;:&nbsp;order.<br/>
<br/>
Global&nbsp;Hint&nbsp;Extern&nbsp;&nbsp;5&nbsp;&nbsp;(weight&nbsp;(?φ&nbsp;⇢&nbsp;(?ψ&nbsp;⇢&nbsp;?θ))&nbsp;&lt;&nbsp;_)&nbsp;=&gt;&nbsp;(eapply&nbsp;Nat.le_lt_trans;&nbsp;<span class="inlinecode"><span class="id" title="tactic">eapply</span></span> <span class="inlinecode"><span class="id" title="var">make_impl_weight2</span>|</span>)&nbsp;:&nbsp;order.<br/>
<br/>
<span class="comment">(*&nbsp;TODO:&nbsp;new&nbsp;*)</span><br/>
<br/>
<span class="comment">(*&nbsp;ad&nbsp;hoc&nbsp;*)</span><br/>
Lemma&nbsp;openboxes_env_order&nbsp;Δ&nbsp;δ&nbsp;:&nbsp;&nbsp;(⊗&nbsp;Δ)&nbsp;•&nbsp;δ&nbsp;•&nbsp;δ&nbsp;≺&nbsp;Δ&nbsp;•&nbsp;□&nbsp;δ.<br/>
Proof.<br/>
induction&nbsp;Δ&nbsp;using&nbsp;gmultiset_rec.<br/>
-&nbsp;eapply&nbsp;@env_order_equiv_left_compat&nbsp;with&nbsp;&nbsp;(∅&nbsp;•&nbsp;δ&nbsp;•&nbsp;δ).&nbsp;<br/>
&nbsp;&nbsp;+&nbsp;now&nbsp;rewrite&nbsp;open_boxes_empty.<br/>
&nbsp;&nbsp;+&nbsp;apply&nbsp;env_order_2;&nbsp;simpl;&nbsp;try&nbsp;lia.&nbsp;ms.<br/>
-&nbsp;apply&nbsp;(@env_order_equiv_right_compat&nbsp;_&nbsp;&nbsp;_&nbsp;(Δ&nbsp;•&nbsp;□&nbsp;δ&nbsp;•&nbsp;x));&nbsp;<span class="inlinecode"><span class="id" title="var">ms</span>|</span>.<br/>
&nbsp;&nbsp;eapply&nbsp;(@env_order_equiv_left_compat&nbsp;&nbsp;_&nbsp;_&nbsp;(⊗&nbsp;Δ&nbsp;•&nbsp;δ&nbsp;•&nbsp;δ&nbsp;•&nbsp;&nbsp;⊙&nbsp;x)).<br/>
&nbsp;&nbsp;rewrite&nbsp;open_boxes_disj_union,&nbsp;open_boxes_singleton.&nbsp;ms.<br/>
&nbsp;&nbsp;case&nbsp;x;&nbsp;intros;&nbsp;simpl;&nbsp;try&nbsp;(solve<span class="inlinecode"><span class="id" title="var">now</span></span> <span class="inlinecode"><span class="id" title="tactic">apply</span></span> <span class="inlinecode"><span class="id" title="var">env_order_add_compat</span></span>).<br/>
&nbsp;&nbsp;transitivity&nbsp;(Δ&nbsp;•&nbsp;□δ&nbsp;•&nbsp;f).<br/>
&nbsp;&nbsp;+&nbsp;auto&nbsp;with&nbsp;*.<br/>
&nbsp;&nbsp;+&nbsp;apply&nbsp;env_order_1.&nbsp;simpl.&nbsp;auto.<br/>
Qed.<br/>
*)</span><br/>

<br/>
<span class="id" title="keyword">Infix</span> <a id="76364ed22a942cd0c08a3d02d3963dec" class="idref" href="#76364ed22a942cd0c08a3d02d3963dec"><span class="id" title="notation">&quot;</span></a>≺·" := <a class="idref" href="ISL.Order.html#pointed_senv_order"><span class="id" title="definition">pointed_senv_order</span></a> (<span class="id" title="tactic">at</span> <span class="id" title="keyword">level</span> 150).<br/>
<span class="id" title="keyword">Global Hint Rewrite</span> <a class="idref" href="ISL.Order.html#senv_weight_add"><span class="id" title="lemma">senv_weight_add</span></a> : <span class="id" title="var">order</span>.<br/>
<span class="comment">(*&nbsp;Global&nbsp;Hint&nbsp;Resolve&nbsp;openboxes_env_order&nbsp;:&nbsp;order.&nbsp;*)</span><br/>
<span class="id" title="keyword">Global Hint Resolve</span> <span class="id" title="var">senv_le_weight</span> : <span class="id" title="var">order</span>.<br/>
<span class="id" title="keyword">Global Hint Unfold</span> <a class="idref" href="ISL.Formulas.html#form_order"><span class="id" title="definition">form_order</span></a> : <span class="id" title="var">mset</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="senv_order_remove_weak" class="idref" href="#senv_order_remove_weak"><span class="id" title="lemma">senv_order_remove_weak</span></a> <a id="p:26" class="idref" href="#p:26"><span class="id" title="binder">p</span></a> <a id="d:27" class="idref" href="#d:27"><span class="id" title="binder">d</span></a> <a id="429bde08aec4510dd7c009bdb80fa47b" class="idref" href="#429bde08aec4510dd7c009bdb80fa47b"><span class="id" title="binder">Δ</span></a> <a id="25dbd6aa491e5149679c6579fb0ae954" class="idref" href="#25dbd6aa491e5149679c6579fb0ae954"><span class="id" title="binder">φ</span></a>:<br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Peano.html#cb53cf0ee22c036a03b4a9281c68b5a3"><span class="id" title="notation">(</span></a>@<a class="idref" href="ISL.Order.html#senv_weight"><span class="id" title="definition">senv_weight</span></a> <a class="idref" href="ISL.Order.html#p:26"><span class="id" title="variable">p</span></a> (<a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Lists.List.html#remove"><span class="id" title="definition">remove</span></a> <a class="idref" href="ISL.Order.html#d:27"><span class="id" title="variable">d</span></a> <a class="idref" href="ISL.Order.html#25dbd6aa491e5149679c6579fb0ae954"><span class="id" title="variable">φ</span></a> <a class="idref" href="ISL.Order.html#429bde08aec4510dd7c009bdb80fa47b"><span class="id" title="variable">Δ</span></a>)<a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Peano.html#cb53cf0ee22c036a03b4a9281c68b5a3"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Peano.html#cb53cf0ee22c036a03b4a9281c68b5a3"><span class="id" title="notation">&lt;=</span></a> @<a class="idref" href="ISL.Order.html#senv_weight"><span class="id" title="definition">senv_weight</span></a> <a class="idref" href="ISL.Order.html#p:26"><span class="id" title="variable">p</span></a> <a class="idref" href="ISL.Order.html#429bde08aec4510dd7c009bdb80fa47b"><span class="id" title="variable">Δ</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
<span class="id" title="tactic">unfold</span> <a class="idref" href="ISL.Order.html#senv_weight"><span class="id" title="definition">senv_weight</span></a>.<br/>
<span class="id" title="tactic">induction</span> <span class="id" title="var">Δ</span> <span class="id" title="keyword">as</span> [| <span class="id" title="var">a</span> <span class="id" title="var">Δ</span>]; <span class="id" title="tactic">simpl</span>.<br/>
- <span class="id" title="tactic">constructor</span>.<br/>
- <span class="id" title="tactic">case</span> <span class="id" title="var">d</span>; <span class="id" title="tactic">intro</span>; <span class="id" title="tactic">subst</span>; <span class="id" title="tactic">simpl</span>; <span class="id" title="var">lia</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="senv_order_remove" class="idref" href="#senv_order_remove"><span class="id" title="lemma">senv_order_remove</span></a> <a id="p:30" class="idref" href="#p:30"><span class="id" title="binder">p</span></a> <a id="d:31" class="idref" href="#d:31"><span class="id" title="binder">d</span></a> <a id="2bcbcfac893072643a1e60157be04321" class="idref" href="#2bcbcfac893072643a1e60157be04321"><span class="id" title="binder">Δ</span></a> <a id="b0bb32d01f678d17055964f3e3249188" class="idref" href="#b0bb32d01f678d17055964f3e3249188"><span class="id" title="binder">φ</span></a>: <a class="idref" href="ISL.Order.html#b0bb32d01f678d17055964f3e3249188"><span class="id" title="variable">φ</span></a> <span class="id" title="notation">∈</span> <a class="idref" href="ISL.Order.html#2bcbcfac893072643a1e60157be04321"><span class="id" title="variable">Δ</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="ISL.Order.html#pow_weight"><span class="id" title="definition">pow_weight</span></a> <a class="idref" href="ISL.Order.html#b0bb32d01f678d17055964f3e3249188"><span class="id" title="variable">φ</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Peano.html#0dacc1786c5ba797d47dd85006231633"><span class="id" title="notation">+</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Peano.html#0dacc1786c5ba797d47dd85006231633"><span class="id" title="notation">(</span></a>@<a class="idref" href="ISL.Order.html#senv_weight"><span class="id" title="definition">senv_weight</span></a> <a class="idref" href="ISL.Order.html#p:30"><span class="id" title="variable">p</span></a> (<a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Lists.List.html#remove"><span class="id" title="definition">remove</span></a> <a class="idref" href="ISL.Order.html#d:31"><span class="id" title="variable">d</span></a> <a class="idref" href="ISL.Order.html#b0bb32d01f678d17055964f3e3249188"><span class="id" title="variable">φ</span></a> <a class="idref" href="ISL.Order.html#2bcbcfac893072643a1e60157be04321"><span class="id" title="variable">Δ</span></a>)<a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Peano.html#0dacc1786c5ba797d47dd85006231633"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Peano.html#cb53cf0ee22c036a03b4a9281c68b5a3"><span class="id" title="notation">&lt;=</span></a> @<a class="idref" href="ISL.Order.html#senv_weight"><span class="id" title="definition">senv_weight</span></a> <a class="idref" href="ISL.Order.html#p:30"><span class="id" title="variable">p</span></a> <a class="idref" href="ISL.Order.html#2bcbcfac893072643a1e60157be04321"><span class="id" title="variable">Δ</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
<span class="id" title="tactic">intro</span> <span class="id" title="var">Hin</span>.<br/>
<span class="id" title="tactic">induction</span> <span class="id" title="var">Δ</span> <span class="id" title="keyword">as</span> [| <span class="id" title="var">a</span> <span class="id" title="var">Δ</span>]; <span class="id" title="tactic">simpl</span>.<br/>
- <span class="id" title="var">contradict</span> <span class="id" title="var">Hin</span>. <span class="id" title="tactic">auto</span> <span class="id" title="keyword">with</span> *.<br/>
- <span class="id" title="tactic">rewrite</span> <a class="idref" href="ISL.Order.html#senv_weight_add"><span class="id" title="lemma">senv_weight_add</span></a>. <span class="id" title="tactic">case</span> <span class="id" title="var">d</span>; <span class="id" title="tactic">intro</span>; <span class="id" title="tactic">subst</span>; <span class="id" title="tactic">simpl</span>.<br/>
&nbsp;&nbsp;+ <span class="id" title="tactic">pose</span> (<a class="idref" href="ISL.Order.html#senv_order_remove_weak"><span class="id" title="lemma">senv_order_remove_weak</span></a> <span class="id" title="var">d</span> <span class="id" title="var">Δ</span> <span class="id" title="var">a</span>). <span class="id" title="var">lia</span>.<br/>
&nbsp;&nbsp;+ <span class="id" title="tactic">rewrite</span> <a class="idref" href="ISL.Order.html#senv_weight_add"><span class="id" title="lemma">senv_weight_add</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="lemma">elem_of_cons</span> <span class="id" title="tactic">in</span> <span class="id" title="var">Hin</span>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">Hin</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">Hf</span> | <span class="id" title="var">Hin</span>]; [<span class="id" title="tactic">tauto</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">specialize</span> (<span class="id" title="var">IHΔ</span> <span class="id" title="var">Hin</span>). <span class="id" title="var">lia</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="comment">(*&nbsp;TODO:&nbsp;technical.&nbsp;move&nbsp;*)</span><br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="lt_le_add_trans_r" class="idref" href="#lt_le_add_trans_r"><span class="id" title="lemma">lt_le_add_trans_r</span></a> <a id="a:34" class="idref" href="#a:34"><span class="id" title="binder">a</span></a> <a id="b:35" class="idref" href="#b:35"><span class="id" title="binder">b</span></a> <a id="c:36" class="idref" href="#c:36"><span class="id" title="binder">c</span></a> <a id="x:37" class="idref" href="#x:37"><span class="id" title="binder">x</span></a> :(<a class="idref" href="ISL.Order.html#a:34"><span class="id" title="variable">a</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Peano.html#cb53cf0ee22c036a03b4a9281c68b5a3"><span class="id" title="notation">&lt;=</span></a> <a class="idref" href="ISL.Order.html#b:35"><span class="id" title="variable">b</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="ISL.Order.html#c:36"><span class="id" title="variable">c</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Peano.html#::nat_scope:x_'&lt;'_x"><span class="id" title="notation">&lt;</span></a> <a class="idref" href="ISL.Order.html#x:37"><span class="id" title="variable">x</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Peano.html#0dacc1786c5ba797d47dd85006231633"><span class="id" title="notation">+</span></a> <a class="idref" href="ISL.Order.html#a:34"><span class="id" title="variable">a</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="ISL.Order.html#c:36"><span class="id" title="variable">c</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Peano.html#::nat_scope:x_'&lt;'_x"><span class="id" title="notation">&lt;</span></a> <a class="idref" href="ISL.Order.html#x:37"><span class="id" title="variable">x</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Peano.html#0dacc1786c5ba797d47dd85006231633"><span class="id" title="notation">+</span></a> <a class="idref" href="ISL.Order.html#b:35"><span class="id" title="variable">b</span></a>).<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="var">lia</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Ltac</span> <span class="id" title="var">order_tac</span> :=<br/>
<span class="id" title="tactic">unfold</span> <a class="idref" href="ISL.Order.html#pointed_senv_order"><span class="id" title="definition">pointed_senv_order</span></a>;<br/>
<span class="id" title="tactic">repeat</span> (<span class="id" title="tactic">apply</span> <a class="idref" href="ISL.Order.html#env_order_add_compat"><span class="id" title="lemma">env_order_add_compat</span></a>); <span class="id" title="tactic">simpl</span>;<br/>
<span class="id" title="tactic">unfold</span> <a class="idref" href="ISL.Order.html#senv_order"><span class="id" title="definition">senv_order</span></a>, <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Arith.Wf_nat.html#ltof"><span class="id" title="definition">ltof</span></a>; <span class="id" title="tactic">repeat</span> <span class="id" title="tactic">rewrite</span> <a class="idref" href="ISL.Order.html#senv_weight_add"><span class="id" title="lemma">senv_weight_add</span></a>;<br/>
<span class="id" title="tactic">try</span> <span class="id" title="keyword">match</span> <span class="id" title="keyword">goal</span> <span class="id" title="keyword">with</span> | <span class="id" title="var">Δ</span> := <span class="id" title="var">_</span> |- <span class="id" title="var">_</span> =&gt; <span class="id" title="tactic">subst</span> <span class="id" title="var">Δ</span> <span class="id" title="keyword">end</span>;<br/>
<span class="id" title="tactic">repeat</span> <span class="id" title="keyword">match</span> <span class="id" title="keyword">goal</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;| <span class="id" title="var">Heq</span> : <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Specif.html#existT"><span class="id" title="constructor">existT</span></a> ?<span class="id" title="var">a</span> <span class="id" title="var">_</span> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Specif.html#existT"><span class="id" title="constructor">existT</span></a> ?<span class="id" title="var">a</span> <span class="id" title="var">_</span> |- <span class="id" title="var">_</span> =&gt; <span class="id" title="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Logic.Eqdep.html#EqdepTheory.inj_pair2"><span class="id" title="lemma">Eqdep.EqdepTheory.inj_pair2</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">Heq</span>; <span class="id" title="tactic">subst</span><br/>
&nbsp;&nbsp;| <span class="id" title="var">Heq</span> : <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Specif.html#existT"><span class="id" title="constructor">existT</span></a> ?<span class="id" title="var">a</span> <span class="id" title="var">_</span> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Specif.html#existT"><span class="id" title="constructor">existT</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> |- <span class="id" title="var">_</span> =&gt; <span class="id" title="tactic">inversion</span> <span class="id" title="var">Heq</span>; <span class="id" title="tactic">subst</span> <span class="id" title="var">a</span><br/>
&nbsp;&nbsp;| <span class="id" title="var">Heq</span> : <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Specif.html#existT"><span class="id" title="constructor">existT</span></a> ?<span class="id" title="var">n</span> ?<span class="id" title="var">θ</span> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <span class="id" title="var">_</span>  |- <span class="id" title="var">_</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">try</span> <span class="id" title="tactic">subst</span> <span class="id" title="var">n</span>; <span class="id" title="tactic">try</span> <span class="id" title="tactic">subst</span> <span class="id" title="var">θ</span>; <span class="id" title="tactic">inversion</span> <span class="id" title="var">Heq</span>;<br/>
&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Specif.html#sigT_eta"><span class="id" title="definition">sigT_eta</span></a> <span class="id" title="tactic">in</span> *; <span class="id" title="tactic">subst</span>; <span class="id" title="tactic">simpl</span> <span class="id" title="tactic">in</span> * <span class="id" title="keyword">end</span>;<br/>
<span class="id" title="tactic">repeat</span> <span class="id" title="tactic">rewrite</span> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Arith.PeanoNat.html#Nat.add_assoc"><span class="id" title="lemma">Nat.add_assoc</span></a>;<br/>
&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">try</span> <span class="id" title="keyword">match</span> <span class="id" title="keyword">goal</span> <span class="id" title="keyword">with</span> <span class="id" title="var">Hin</span> : ?ψ <span class="id" title="notation">∈</span> ?<span class="id" title="var">Γ</span> |- <span class="id" title="keyword">context</span> <span class="id" title="var">C</span> [<a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Lists.List.html#remove"><span class="id" title="definition">remove</span></a> ?<span class="id" title="var">d</span> ?ψ ?<span class="id" title="var">Γ</span>] =&gt;<br/>
&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Arith.PeanoNat.html#Nat.lt_le_trans"><span class="id" title="lemma">Nat.lt_le_trans</span></a>; [| <span class="id" title="tactic">exact</span> (<a class="idref" href="ISL.Order.html#senv_order_remove"><span class="id" title="lemma">senv_order_remove</span></a> (<a class="idref" href="ISL.SizedFormulas.html#nform_eq_dec"><span class="id" title="instance">nform_eq_dec</span></a> <span class="id" title="var">_</span>) <span class="id" title="var">Hin</span>)] ||<br/>
&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> (<a class="idref" href="ISL.Order.html#lt_le_add_trans_r"><span class="id" title="lemma">lt_le_add_trans_r</span></a> <span class="id" title="var">_</span> (<a class="idref" href="ISL.Order.html#senv_order_remove"><span class="id" title="lemma">senv_order_remove</span></a> (<a class="idref" href="ISL.SizedFormulas.html#nform_eq_dec"><span class="id" title="instance">nform_eq_dec</span></a> <span class="id" title="var">_</span>) <span class="id" title="var">Hin</span>))<br/>
<span class="id" title="keyword">end</span>;<br/>
<span class="id" title="tactic">repeat</span> <span class="id" title="tactic">rewrite</span> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Arith.PeanoNat.html#Nat.add_assoc"><span class="id" title="lemma">Nat.add_assoc</span></a>;<br/>
<span class="id" title="tactic">try</span> <span class="id" title="tactic">refine</span> (<a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Arith.PeanoNat.html#Nat.add_lt_le_mono"><span class="id" title="lemma">Nat.add_lt_le_mono</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> (<a class="idref" href="ISL.Order.html#senv_weight_open_boxes"><span class="id" title="lemma">senv_weight_open_boxes</span></a> <span class="id" title="var">_</span>));<br/>
<span class="id" title="tactic">unfold</span> <a class="idref" href="ISL.Order.html#pow_weight"><span class="id" title="definition">pow_weight</span></a>, <a class="idref" href="ISL.Order.html#form_of_sig"><span class="id" title="definition">form_of_sig</span></a>; <span class="id" title="tactic">simpl</span> <a class="idref" href="ISL.Formulas.html#weight"><span class="id" title="definition">weight</span></a>;<br/>
<span class="id" title="tactic">repeat</span> <span class="id" title="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Arith.PeanoNat.html#Nat.add_lt_mono_r"><span class="id" title="lemma">Nat.add_lt_mono_r</span></a>;<br/>
<span class="id" title="tactic">simpl</span> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Arith.PeanoNat.html#Nat.pow"><span class="id" title="definition">Nat.pow</span></a>;<br/>
<span class="id" title="tactic">repeat</span> <span class="id" title="tactic">rewrite</span> ?<a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Arith.PeanoNat.html#Nat.pow_succ_r'"><span class="id" title="lemma">Nat.pow_succ_r'</span></a>, ?<a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Arith.PeanoNat.html#Nat.pow_add_r"><span class="id" title="lemma">Nat.pow_add_r</span></a>;<br/>
<span class="id" title="tactic">repeat</span> <span class="id" title="keyword">match</span> <span class="id" title="keyword">goal</span> <span class="id" title="keyword">with</span><br/>
|  |- <span class="id" title="keyword">context</span> <span class="id" title="var">C</span> [<a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Arith.PeanoNat.html#Nat.pow"><span class="id" title="definition">Nat.pow</span></a> 5 (<a class="idref" href="ISL.Formulas.html#weight"><span class="id" title="definition">weight</span></a> ?<span class="id" title="var">δ</span>)] =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">lazymatch</span> <span class="id" title="keyword">goal</span> <span class="id" title="keyword">with</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">H</span> :  5 <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Peano.html#cb53cf0ee22c036a03b4a9281c68b5a3"><span class="id" title="notation">&lt;=</span></a>  5 <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Arith.PeanoNat.html#81fd94e251a61ee523cdd7855774ae7c"><span class="id" title="notation">^</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Arith.PeanoNat.html#81fd94e251a61ee523cdd7855774ae7c"><span class="id" title="notation">(</span></a><a class="idref" href="ISL.Formulas.html#weight"><span class="id" title="definition">weight</span></a> <span class="id" title="var">δ</span><a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Arith.PeanoNat.html#81fd94e251a61ee523cdd7855774ae7c"><span class="id" title="notation">)</span></a> |- <span class="id" title="var">_</span> =&gt; <span class="id" title="tactic">fail</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">_</span> =&gt; <span class="id" title="tactic">pose</span> (<a class="idref" href="ISL.Order.html#pow_weight_gt"><span class="id" title="lemma">pow_weight_gt</span></a> <span class="id" title="var">δ</span>) <span class="id" title="keyword">end</span> <span class="id" title="keyword">end</span>;<br/>
<span class="id" title="tactic">simpl</span>; <span class="id" title="tactic">unfold</span> <a class="idref" href="ISL.Order.html#pow_weight"><span class="id" title="definition">pow_weight</span></a> <span class="id" title="tactic">in</span> *; <br/>
<span class="id" title="tactic">try</span> <span class="id" title="var">remember</span> (<a class="idref" href="ISL.Order.html#senv_weight"><span class="id" title="definition">senv_weight</span></a> <span class="id" title="var">_</span>) <span class="id" title="keyword">as</span> <span class="id" title="var">W</span>; <span class="id" title="tactic">try</span> <span class="id" title="var">nia</span>;<br/>
<span class="id" title="tactic">try</span> <span class="id" title="keyword">match</span> <span class="id" title="keyword">goal</span> <span class="id" title="keyword">with</span> |- <span class="id" title="keyword">context</span> <span class="id" title="var">C</span> [?<span class="id" title="var">a</span> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Peano.html#ea2ff3d561159081cea6fb2e8113cc54"><span class="id" title="notation">*</span></a> ?<span class="id" title="var">b</span> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Peano.html#ea2ff3d561159081cea6fb2e8113cc54"><span class="id" title="notation">*</span></a> ?<span class="id" title="var">c</span>] =&gt;<br/>
&nbsp;&nbsp;&nbsp;(<span class="id" title="tactic">destruct</span> (<a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Arith.PeanoNat.html#Nat.add_le_mul"><span class="id" title="lemma">Nat.add_le_mul</span></a> <span class="id" title="var">a</span> <span class="id" title="var">b</span>); [<span class="id" title="var">lia</span> | <span class="id" title="var">lia</span> | | <span class="id" title="var">lia</span>]) <span class="id" title="keyword">end</span>;<br/>
&nbsp;<span class="id" title="tactic">try</span> <span class="id" title="tactic">eapply</span> (<a class="idref" href="ISL.Order.html#lt_le_add_trans_r"><span class="id" title="lemma">lt_le_add_trans_r</span></a> <span class="id" title="var">_</span> (<a class="idref" href="ISL.Order.html#senv_weight_open_boxes"><span class="id" title="lemma">senv_weight_open_boxes</span></a> <span class="id" title="var">_</span>));<br/>
<span class="id" title="var">nia</span>.<br/>
</div>
</div>
<div id="footer">
  Generated by <a href="http://coq.inria.fr/">coqdoc</a> and improved with <a href="https://github.com/tebbi/coqdocjs">CoqdocJS</a>
</div>
</div>
</body>

</html>
